name = "cloudflare-worker-labs-service"
main = "src/index.ts"
compatibility_date = "2024-11-06"

# D1 Database Binding
[[d1_databases]]
binding = "DB"
database_name = "labs-database"
database_id = "8717224e-bc40-43b5-b564-e36204779191"

# Cron Trigger for automatic cleanup
# Runs every 1 minute to check for expired sessions
[triggers]
crons = ["*/1 * * * *"]

# Migrations - Delete Durable Objects (switching to Cron)
[[migrations]]
tag = "v2"
deleted_classes = ["SessionManager"]

# Environment Variables
[vars]
ENVIRONMENT = "development"
# BACKEND_API_URL will be set via secrets or vars below
# BACKEND_API_TOKEN will be set via secrets (use: npx wrangler secret put BACKEND_API_TOKEN)

# Production Environment
[env.production]
[env.production.vars]
ENVIRONMENT = "production"
# Set production BACKEND_API_URL here or via secrets
# BACKEND_API_URL = "https://your-production-backend.com"
